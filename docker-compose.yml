version: "3.8"

services:
  vg-ms-claims-incidents:
    build:
      context: .
      dockerfile: Dockerfile
    image: vallegrande/vg-ms-claims-incidents:latest
    container_name: vg-ms-claims-inc
    restart: unless-stopped

    expose:
      - "8085"

    environment:
      - SPRING_PROFILES_ACTIVE=${SPRING_PROFILES_ACTIVE:-dev}
      - SERVER_PORT=8085
      - MONGODB_URI=${MONGODB_URI:-mongodb://localhost:27017/db_jass_claims}
      - MONGODB_DATABASE=${MONGODB_DATABASE:-db_jass_claims}
      - RABBITMQ_HOST=${RABBITMQ_HOST:-rabbitmq}
      - RABBITMQ_PORT=${RABBITMQ_PORT:-5672}
      - RABBITMQ_USERNAME=${RABBITMQ_USERNAME:-guest}
      - RABBITMQ_PASSWORD=${RABBITMQ_PASSWORD:-guest}
      - USERS_SERVICE_URL=${USERS_SERVICE_URL:-http://vg-ms-users:8081}
      - ORGANIZATIONS_SERVICE_URL=${ORGANIZATIONS_SERVICE_URL:-http://vg-ms-organizations:8083}

    networks:
      - jass-network

    healthcheck:
      test: [ "CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:8085/actuator/health" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

networks:
  jass-network:
    driver: bridge
    name: jass-digital-network
